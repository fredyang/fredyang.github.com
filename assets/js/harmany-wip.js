/*! Harmony v0.1pre Â© Fred Yang - semanticsworks.com | www.opensource.org/licenses/mit-license.php Include jquery.ba-bbq.js*Copyright (c) 2010 "Cowboy" Ben Alman*/(function(g,y,q){function Wb(e,c){for(var a in c)e[a]||(e[a]=c[a])}function ed(e){return"."===e?"#":(new lb(e.length+2)).join("#")}function Xb(e){if(e===K)return"";var c=Yb.exec(e);return c?c[1].replace(mb,nb):e}function nb(e){return"#"==e?".":(new lb(e.length)).join("#")}function ob(e,c,a){var b,d=e.lastIndexOf(".");k(a)&&(a=!0);if(a){-1===d?(a="",b=e):(a=e.substring(0,d),b=e.substring(d+1));d=a;a=b;for(var f=0;f<ha.length;f++)ha[f](d,a,c)}if(!R(c))for(b in c){d=e;a=b;for(var f=c[b],h=0;h<ha.length;h++)ha[h](d,
a,f);ob(e+"."+b,c[b],!1)}}function Zb(e,c){c=L(c);var a=S[c];a||(S[c]=a=[]);a.pushUnique(e)}function $b(e,c){c=L(c);var a=S[c];a.remove(e);a.length||delete S[c]}function ac(e){return(e=fd.exec(e))&&e[1]||""}function Qa(){return!1}function H(){return!0}function Ra(e,c,a,b,d){this.publisher=T(e);this.originalPublisher=T(c);this.originalType=this.type=a;this.proposed=b;this.removed=d}function bc(e){var c=e.workflow,a=c.getName,c=c.getParas;e=e.publisher;return c?e[a](c):t(e[a])?e[a]():e[a]}function cc(e,
c){var a=c.workflow,b=a.setName;(a=a.setParas)?this[b](a,e):t(this[b])?this[b](e):this[b]=e}function dc(e,c,a){var b=ia.getId(c);return g.map(e.split(ja),function(c){return n(a)?c+"."+K+"."+b+"."+a:c+"."+K+"."+b+"."+ia.getId(a)}).join(" ")}function T(e){if(n(e))return j(e);if(s(e)&&!e.nodeType)return e;if(!k(e))return g(e)}function gd(e){return"."==e?"\\.":".*"}function ec(e){var c,a,b;b=e.publisher.subsToMe();for(a=0;a<b.length;a++){c=b[a];var d=e,f;a:{f=c.eventTypes;var h=e.type,g=void 0,j=void 0,
ka=j=g=void 0,k=void 0;if("*"===f)f="*";else{f=f.split(ja);for(k=0;k<f.length;k++)if(j=f[k],j=(ka=fc.test(j))?j.replace(fc,""):j,j=j.replace(hd,gd),j=ka?"^"+j:"^"+j+"$",g=new A(j),g=g.test(h))if(ka){if(ka="^"==j?h:A.rightContext,!ka||!ka.contains(".")){f=f[k];break a}}else{f=f[k];break a}f=void 0}}d.matchedType=f;e.matchedType&&Sa(T(c.subscriber),c.workflow,e);if(e.isImmediatePropagationStopped())return}if(!e.isCascadeStopped()&&(c=S[e.publisher.path]))for(b=0;b<c.length;b++){a=x(c[b],e.originalPublisher.path,
e.type);if(a.isImmediatePropagationStopped()||a.isImmediatePropagationStopped())break;a.hasError()&&e.error()}}function Sa(e,c,a,b){var d;a.workflow=c;a.subscriber=e;b=k(b)?c.get.call(e,a):c.get.apply(e,[a].concat(b));aa(b)?(d=m(!0,{},a),b.done(function(b){c.convert&&(b=c.convert.call(e,b,a));if(!k(b))if(aa(b))b.done(function(a){Ta(e,c,a,d)});else return Ta(e,c,b,a)})):(c.convert&&(b=c.convert.call(e,b,a)),k(b)||(aa(b)?(d=m(!0,{},a),b.done(function(a){Ta(e,c,a,d)})):Ta(e,c,b,a)))}function Ta(e,c,
a,b){k(a)||(a===la&&(a=q),c.set&&c.set.call(e,a,b),c.finalize&&c.finalize.call(e,a,b))}function ma(e){e.publisher=T(e.currentTarget);e.originalPublisher=T(e.target);var c=T(e.data.subscriber),a=e.data.workflow;delete e.data;1<arguments.length?Sa(c,a,e,v.call(arguments,1)):Sa(c,a,e)}function gc(e,c,a,b){e=e||"";if(n(e)){var d,f=e.split(ja),h;if(1==f.length)if(e.startsWith("*")){d=ba[e.substr(1)];if(!d)throw"common workflow "+e+" does not exist";d=m({},d)}else if(e.startsWith("#")?(d=e.substr(1),d=
n(a)?I(a,d):n(c)?I(c,d):d,d=r.raw(d)):d=void 0,d)if(t(d))d=m({get:d,options:b},d);else if(s(d)&&d.get)d=m({options:b},d);else throw"missing handler";else if(!k(c)&&!k(a)){d=n(c);f=n(a);if(d)e={get:"get",set:e||"set"};else if(f)if(e)e={get:e,set:"set"};else if(e=r.raw(a),t(e))e={get:r.raw(a)};else{if(!s(e)||!e.get)throw"missing handler";}else e={get:e,set:e};d=e}else throw"invalid handler";else{d={};for(var g=0;g<Ua.length;g++)e=f[g],h=Ua[g],e&&("_"!==e&&"null"!=e)&&(d[h]=e)}e=d}else if(t(e))e=m({get:e,
options:b},e);else if(s(e)&&e.get)e=m({options:b},e);else throw"invalid workflow expression";d=e;f=d.initialize;if(n(f))if(f.startsWith("*")){if(f=j.activity.initialize[f.substring(1)],!f)throw"initialize activity does not exist!";}else{var u=f;if(!r.raw(u))throw"initialize activity does not exist at path "+u;f=function(a,b,c,d){r.set(u,a,b,c,d)}}f?f(T(c),T(a),d,b):k(b)||(d.options=b);Va("get",e,c,a);Va("set",e,c,a);Ba(e,"convert");Ba(e,"finalize");return e}function hc(e){var c;if(n(e)){var a=e.split(ja),
b;if(1<a.length){e={};for(var d=0;d<Ua.length;d++)c=a[d],b=Ua[d],c&&("_"!==c&&"null"!=c)&&(e[b]=c)}else throw"invalid workflow type";c=e}else if(t(e)||s(e)&&e.get)c=e,t(e)&&(c=m({get:e},c));else throw"invalid workflow expression";Ba(c,"initialize");Va("get",c);Va("set",c);Ba(c,"convert");Ba(c,"finalize");return c}function Va(e,c,a,b){var d=c[e];if(d&&n(d)){var f=j.activity[e];if(d.startsWith("*")){if(d=d.substr(1),c[e]=f[d],!c[e])throw d+" does not exists "+e+" Activity";}else if(d=d.split("*"),c[e]=
"get"==e?bc:cc,c[e+"Name"]=d[0],d[1]&&(c[e+"Paras"]=d[1]),!k(a)&&!k(b)){c=d[0];a="get"==e?a:b;var h;n(a)?M[c]||(h=!0):a.nodeType?na[c]||(h=!0):c in a||(h=!0);if(h)throw("get"==e?"publisher":"subscriber")+" does not have a member "+c;}}}function Ba(e,c){var a=e[c];if(n(a))if(a.startsWith("*")){if(e[c]=j.activity[c][a.substr(1)],!e[c])throw a+"Activity does not exists";}else e[c]=function(){return r.raw(a).apply(this,arguments)}}function ic(e){if(s(e)){if(!ia.getId(e))return;ia.unMark(e)}J.removeBy(e)}
function pb(e,c){if("_"!==c)return c&&c.startsWith("_")?c.substr(1):e||c}function jc(e){if(1===e.nodeType){var c,a,b=e.attributes,d=b[p.subsAttr]&&b[p.subsAttr].nodeValue||"";for(e=0;e<b.length;e++)if(c=b[e],a=c.name.startsWith("!")||c.name.startsWith("$")?c.name.replace(id," "):c.name.replace(jd,kd),"ns"==a||j.behavior[a]||a.startsWith("!")||a.startsWith("$"))d=a+":"+(c.nodeValue||"/")+";"+d;return d}}function ca(e,c,a,b){var d,f;if(e)if(e.nodeType){if(b=e,e=c||jc(b)){c=new ca;c.elem=b;a=c;a:{for(b=
g(b);(b=b.parent())&&b.length;)if(d=b.hmData("ns"),!k(d)){b=d;break a}b=""}a.ns=b;return new ca(e,c)}}else{if(!c)return c=new ca,c.elem={},new ca(e,c);this.sub=[];this.pub=[];for(this.behaviors=[];f=ld.exec(e);){var h=f[1],j=g.trim(f[2]);f=g.trim(f[3]);h?this["$"==h?"pub":"sub"].push({eventTypes:j,value:f}):"ns"==j?d=f:this.behaviors.push({behaviorName:j,value:f})}this.ns=I(I(c.ns,a),d);this.text=e;this.elem=c.elem;this.subscriptions=c.subscriptions;c.elemBehavior?this.elemBehavior=c.elemBehavior:
(this.elemBehavior=this,g(this.elem).hmData("ns",this.ns));this.options=pb(c.options,b);this.importBehaviors();this.importSubscriptions("sub");this.importSubscriptions("pub");this.debug&&this.print()}else this.subscriptions=[]}function qb(e){var c,a,b,d=g(e);if(!d.hmData("parsed")&&(c=jc(e))){e=new ca(e,c);c=e.subscriptions;e.preImport&&e.preImport();for(a=0;a<c.length;a++)b=c[a],j.sub(b.subscriber,b.publisher,b.eventTypes,b.handler,b.options,b.delegate);e.postImport&&e.postImport();d.hmData("parsed",
!0)}d.children().each(function(){qb(this)})}function Wa(e,c){if(s(e)){for(var a in e)Wa(a,e[a]);return this}z(c)&&(c=c.concat(";"));Wa[e]=c;return this}function oa(e,c,a){return m({},rb,s(e)?e:{get:e,set:c,finalize:a})}function kc(e){this.modelPath=e.publisher.path;this.e=e}function lc(e){e=e||C.defaultEngine;if(!e)throw"engine name is not specified or default engine name is null";e=Xa[e];if(!e)throw"engine '"+e+"' can not be found.";return e}function mc(e){e=e[0];return"true"==e.value?!0:"false"==
e.value?!1:"on"!==e.value?e.value:e.checked}function nc(e,c,a,b){a:{var d,f;if(a)for(d=pa.length-1;0<=d;d--){if(f=pa[d],f.name==a){a=f;break a}}else for(d=pa.length-1;0<=d;d--)if(f=pa[d],f.match&&f.match(e)){a=f;break a}a=void 0}if(!a||!a[b])throw"can not find "+b+" method for view";c[b+"ViewValue"]=a[b];a.convert&&(c.convert=a.convert);e.hmData("valueBound")||(a.initialize&&a.initialize(e),e.hmData("valueBound",!0))}function md(e){var c=this.path;e=e.originalPublisher.path;var a=e.substr(c.length+
1),b=a.indexOf("."),c=c+"."+a.substr(0,b)+".__state";e!==c&&j.get(c)==D.unchanged&&j.set(c,D.modified)}function Ya(e,c){var a=e.get();return a.constructor[c](a).done(function(){e.set("__state","destroy"==c?D.detached:D.unchanged);e.trigger("afterSync."+c)})}function oc(e){if(""===e)return!Ca.length;for(var c=e+".",a=0,b,d=Ca.length;a<d;a++)if(b=Ca[a],b==e||b.startsWith(c))return!1;return!0}function qa(e,c){return c?function(a){return!e.test(a)}:function(a){return e.test(a)}}function Z(e,c){return c.error||
e.supplant(c)}function pc(e){var c=j(e+"*errors");c.isEmpty()||(c.clear(),Za.removeItem(e))}function nd(e){return{initialize:e.initialize,get:function(c){var a,b,d=c.publisher;a=c.workflow.options;var f=c.proposed;c=e.name&&p.errors[e.name];if(e.buildError)c=e.buildError(c,a);else{var h=s(a)?a.error:a;c=c&&c.contains("{0}")?c.format.apply(c,h.split(",")):h||c||e.error}if(null===f||f===q||qc.test(f)){a:{a=j(d.path).subsToMe();for(f=0;f<a.length;f++)if(a[f].workflow.get===od){a=!0;break a}a=!1}a?(a=
!1,b=!0):a=!0}else a=e.isValid(f,a);a?d.removeError(c):!b||"required"===e.name?d.addError(c):d.removeError(c)}}}function rc(e,c){for(var a=j.subscription.getAll(),b={},d=a.length-1,f,h;0<=d;d--)f=a[d],h=f.publisher,n(h)&&(!b[h]&&h.startsWith(e)&&f.eventTypes.contains("checkValidity"))&&(b[h]=!0,c(h))}function sb(e){return function(){for(var c=v.call(arguments),a=0;a<e.length;a++)e[a].apply(this,c)}}function sc(e,c){if("string"===typeof e){if(c){for(var a=1,b=U(e);a<b.length;)V(b[a],b[a-1]),a++;e=
b[b.length-1]}var d=e,a=[],b=U(d);if(1===b.length)a=tc(b[0]);else{for(var f=0;f<b.length;f++)a.push(tc(b[f]));a=g.when.apply(g,a)}return $a(a).fail(function(){l.unload(d)})}if(g.isArray(e)){for(var a=e,h=[],j,u={ok:!0},f=0;f<a.length;f++)j=a[f],h.push(j),b=0===f?sc(j).fail(uc(j,u)):b.nextLoad(j).fail(uc(h.slice(),u));return $a(b)}throw"resource parameter should be an array or string";}function uc(e,c){return function(){c.ok&&(l.unload(e),c.ok=!1)}}function tc(e){var c=ra(e);if(c){var a=N(e);if(!a){a=
c.load(e);if(!a||!a.done)a=g.Deferred().resolve(e,a).promise();c.noRefCount||N(e,a)}"staticLoaded"!==a.refCount&&(a.refCount=a.refCount?a.refCount+1:1);return a}return l(ab(e)+".loader").nextLoad(e)}function N(e,c){if(e===q)return W;if(c===q){if(1===arguments.length)return W[e];delete W[e]}else return W[e]=c}function $a(e){var c=g.Deferred();e.nextLoad=function(a){var b=v.call(arguments);e.then(function(){l.apply(null,b).then(function(){c.resolve.apply(c,v.call(arguments))},function(){c.reject(a)})},
function(){c.reject(a)});return $a(c.promise())};e.andLoad=function(){var a=l.apply(null,arguments);return $a(g.when(a,e))};return e}function U(e){return e.replace(pd,"").split(qd)}function vc(e){e=wc.exec(e.toLowerCase());return!(!e||!(e[1]!=bb[1]||e[2]!=bb[2]||(e[3]||("http:"===e[1]?80:443))!=(bb[3]||("http:"===bb[1]?80:443))))}function tb(e){ub.href=rd.test(e)?e:l.baseUrl+e;vc(e)?e=ub.href:(e=ub.href,e=Da(e),e=sa?e+(sd.test(e)?"&":"?")+Ea+"="+sa:e);return e}function Da(e){return""===sa?e:e.replace(xc,
"")}function yc(e,c){var a=g.extend(!0,{},W);l.unload(e,!0);c&&c();return l(e).done(function(){for(var b in a)W[b]&&a[b]&&(W[b].refCount=a[b].refCount,W[b].url=a[b].url,W[b].moduleId=a[b].moduleId)})}function td(e,c){if(e&&!c||c&&!e)return!0;if(!e&&!c)return!1;e=U(e).sort();c=U(c).sort();if(e.length!=c.length)return!0;for(var a=0;a<e.length;a++)if(e[a]!=c[a])return!0;return!1}function ra(e){var c,a;for(a=vb.length-1;0<=a&&!(c=vb[a](e));a--);c=c||l.defaultLoader;return wb[c]}function zc(e,c,a){var b=
N(e),d=b.defer;delete b.defer;b.unload=a;d&&d.resolve(e,c())}function Ac(e){g("<link href='"+l.url(e)+"' rel='stylesheet' type='text/css' loadedByMatrix='1' />").appendTo("head")}function ud(e){var c;c=e.publisher;if(1===e.level){c=c.get().table;for(var a in c)if(c[a]==e.removed){this.set(a,e.proposed);break}}else if(2<=e.level){a=e.originalPublisher.path.substr(c.path.length+1);var b=a.substr(0,a.indexOf("."));g.isNumeric(b)&&(a="table."+c.keyAt(b)+a.substr(a.indexOf(".")),c.trigger(a,"afterUpdate",
e.proposed,e.removed))}}function vd(e){this.set("c"+e.publisher.get().guid++,e.proposed)}function wd(e){var c=this.get();e=e.removed;for(var a in c)if(c[a]===e){this.del(a);break}}function xd(e){this.removeItem(e.removed)}function yd(e){this.replaceItem(e.removed,e.proposed)}function xb(e){this.selectedIndex=e}function Fa(e){return"string"===typeof e}function ta(e){var c=v.call(arguments,1);return function(){return e.apply(this,c.concat(v.call(arguments)))}}function Bc(e,c,a,b,d){var f;b!==q?(c=a.match(e?
cb:/^([^#?]*)\??([^#]*)(#?.*)/),a=c[3]||"",2===d&&Fa(b)?b=b.replace(e?db:Cc,""):(f=$(c[2]),b=Fa(b)?$[e?da:ua](b):b,b=2===d?b:1===d?g.extend({},b,f):g.extend({},f,b),b=Dc(b),e&&(b=b.replace(Ec,yb))),e=c[1]+(e?zb:b||!c[1]?"?":"")+b+a):e=c(a!==q?a:E.href);return e}function Fc(e,c,a){c===q||"boolean"===typeof c?(a=c,c=va[e?da:ua]()):c=Fa(c)?c.replace(e?db:Cc,""):c;return $(c,a)}function Gc(e,c,a,b){!Fa(a)&&"object"!==typeof a&&(b=a,a=c,c=q);return this.each(function(){var d=g(this),f=c||Hc()[(this.nodeName||
"").toLowerCase()]||"",h=f&&d.attr(f)||"";d.attr(f,va[e](h,a,b))})}function Ga(e){e=e||E.href;return"#"+e.replace(/^[^#]*#?(.*)$/,"$1")}function zd(e){e=O(e.publisher.path);var c={};c[e]=r.get(e);eb.pushState(c)}function Ic(){if(fb){for(var e=[],c=0;c<fb.length;c++){var a=fb[c];if(n(a))e.push(a);else{var b=r.get(a.modelPath);e.push(!b&&!1!==b?b+"":a.defaultValue)}}e=E.href.replace("#"+E.hash,"")+"#"+e.join("/");Ab(e)}}function Bb(){var e=eb.getState(),c,a;for(a in e){""===e[a]&&(c=a);break}return c}
function Jc(e,c){var a,b,d;if(e&&(d=e.split("/"),d.length===c.length)){for(var f=!0,h=0;h<d.length;h++)if(a=d[h],b=c[h],n(b)){if(b!=a){f=!1;break}}else if(s(b)){if(b=b.constraint)if(n(b)){if(b!=a){f=!1;break}}else if(b.compile){if(!b.test(a)){f=!1;break}}else if(t(b)){if(!b(a)){f=!1;break}}else throw"invalid constraint";}else throw"invalid segment";return f}}function Kc(e,c){var a,b,d=Jc(e,c);d&&(b=e.split("/"));for(var f=0;f<c.length;f++){a=c[f];var h=a.modelPath;k(h)||(d&&(a=b[f],r.set(h,a)),j.sub(null,
h,"afterUpdate",Ad))}return d}function Ad(e){var c;e=e.publisher.path;var a=Bb();if(a)for(var b=0;b<Ha.length;b++){a:{c=a;var d=e,f=Ha[b];if(Jc(c,f))for(var h=void 0,g=c.split("/"),j=0;j<g.length;j++)if(h=f[j],h.modelPath==d){g[j]=r.get(d);d=g.join("/");f=E.hash;c=E.href.replace(f,"")+f.replace(c,d);Ab(c);c=!0;break a}c=!1}if(c)break}}function Lc(e){this.set(e.publisher.attr(e.workflow.options));e.preventDefault();e.stopPropagation()}var j=y.hm=function(e,c){return new Cb(e,c)},Cb=function(e,c){this.path=
L(e||"",!0);k(c)||this.set(c)},F=y.document,Db=y.localStorage,P=y.setTimeout,Mc=y.history,E=y.location,Bd=y.alert,Cd=y.confirm,M,m=g.extend,Eb={},z=g.isArray,t=g.isFunction,Dd={undefined:q,"boolean":q,number:q,string:q},K="__hm",Yb=/^__hm\.([^\.]+?)(?:\.|$)/,Ed=/this\.(?:get)\s*\(\s*(['"])([\*\.\w\/]+)\1\s*\)/g,S={},p={},r,X=Eb[K]={},Fd=Eb.hasOwnProperty,lb=y.Array,Nc=lb.prototype,Gd=String.prototype,v=Nc.slice,x,Hd=/^(?:\{.*\}|\[.*\])$/,Id=/^\.(\.*)([\.\*])/,Jd=/^\.<(.*)/,Oc=/^[\.\*]/,Kd=/[\.\*]/,
Ld=/#+|\./g,mb=/#+/g,A=y.RegExp,fd=/^(.+)[\.\*]\w+$/,I,Md=/^.+\.(\w+)$|\w+/,Q,k,R,n,s,wa,Fb=g.isNumeric,aa,Ia,L,O,Gb,na=g.fn,xa,Nd=/\{([^\{\}]*)\}/g;Wb(Nc,{indexOf:function(e,c){for(var a=c||0;a<this.length;a++)if(this[a]==e)return a;return-1},contains:function(e){return-1!==this.indexOf(e)},remove:function(e){e=this.indexOf(e);-1!=e&&this.splice(e,1);return this},removeAt:function(e){this.splice(e,1);return this},pushUnique:function(e){this.contains(e)||this.push(e);return this},merge:function(e){if(e&&
e.length)for(var c=0;c<e.length;c++)this.pushUnique(e[c]);return this},sortObject:function(e,c){k(c)&&(k(e)?(c=!0,e=q):n(e)?c=!0:(c=e,e=q));e?this.sort(function(a,b){var d=a[e],f=b[e];return d==f?0:c?d>f?1:-1:d>f?-1:1}):c?this.sort():this.sort().reverse();return this}});Wb(Gd,{startsWith:function(e){return 0===this.indexOf(e)},contains:function(e){return-1!==this.indexOf(e)},endsWith:function(e){return-1!==this.indexOf(e,this.length-e.length)},supplant:function(e){return this.replace(Nd,function(c,
a){var b=e[a];return typeof b?b:c})},format:function(){var e=this;g.each(arguments,function(c,a){e=e.replace(new A("\\{"+c+"\\}","g"),a)});return e}});M=Cb.prototype=j.fn=j.prototype={constructor:Cb,toString:function(){return this.path},get:function(e){var c;if(c=this.accessor(e,!0)){if(t(c.hostObj))return c.hostObj.apply(this.cd(".."),v.call(arguments));c=!c.index?c.hostObj:c.hostObj[c.index];return t(c)?c.apply(this.cd(e).cd(".."),v.call(arguments,1)):c}},getJson:function(){return JSON.stringify(this.get.apply(this,
v.call(arguments)))},raw:function(e,c){var a;t(e)&&(c=e,e="");if(c)return a=this.accessor(e),a.index in a.hostObj?this.update(e,c,a):this.create(e,c,a);if(a=this.accessor(e,!0))return!a.index?a.hostObj:a.hostObj[a.index]},set:function(e,c,a){if(1==arguments.length){if(""===this.path)throw"root object can not changed";r.set(this.path,e,c);return this}var b=v.call(arguments);if(wa(e)){if(2==arguments.length)return r.set(e,this.path,c),this}else a=c,c=e,e=!1;var d=this.accessor(c),f=d.hostObj[d.index];
return t(f)?(f.apply(this.cd(c).cd(".."),v.call(b,1)),this):d.index in d.hostObj?this.update(e,c,a,d):this.create(e,c,a,d)},accessor:function(e,c){0===e&&(e="0");var a,b,d=Eb,f=this.getPath(e),h=L(f,!0),g=h.split(".");if(1===g.length)b=h;else{b=g[g.length-1];for(a=0;a<g.length-1&&!(d=d[g[a]],d===q);a++);}if(R(d)){if(c)return;throw"invalid update on unreachable node '"+O(f)+"'";}return{physicalPath:h,hostObj:d,index:b}},create:function(e,c,a,b){wa(e)||(b=a,a=c,c=e,e=!1);b=b||this.accessor(c);c=b.physicalPath;
var d=b.hostObj,f=b.index,h=z(d);if(h&&Fb(f)){if(f>d.length)throw"you can not add item with hole in array";}else if(f in d)throw"value at path: '"+O(b.physicalPath)+"' has been defined, try use update method instead";if(!e&&x(c,c,"beforeCreate",a).hasError())return!1;h&&Fb(f)?f==d.length?d[f]=a:f<d.length&&d.splice(b.index,0,a):d[b.index]=a;x(c,c,"afterCreate",a);ob(c,a);return this},extend:function(e,c){var a;c?a=this.cd(e):(c=e,a=this);for(var b in c)a.set(b,c[b]);return this},update:function(e,
c,a,b){if(1==arguments.length){if(""===this.path)throw"root object can not updated";r.update(this.path,e);return this}if(wa(e)){if(2==arguments.length)return r.update(e,this.path,c),this}else b=a,a=c,c=e,e=!1;b=b||this.accessor(c);if(!(b.index in b.hostObj))throw"value at path: '"+O(b.physicalPath)+"' has been not defined, try use create method instead";var d=b.physicalPath,f=b.hostObj[b.index];if(f==a)return this;if(!e&&x(d,d,"beforeUpdate",a,f).hasError())return!1;b.hostObj[b.index]=a;e||x(d,d,
"afterUpdate",a,f);ob(d,a);return this},del:function(e){if(k(e)){if(this.path)return r.del(this.path);throw"root can not be deleted";}var c=this.accessor(e),a=c.hostObj;e=c.physicalPath;var b=a[c.index],d=z(a);if(x(e,e,"beforeDel",q,b).hasError())return!1;x(e,e,"duringDel",q,b);d?a.splice(c.index,1):delete a[c.index];for(c=0;c<gb.length;c++)gb[c](e,b);x(e,e,"afterDel",q,b);return b},createIfUndefined:function(e,c){if(k(c))throw"missing value argument";var a=this.accessor(e);return a.index in a.hostObj?
this:this.create(e,c,a)},toggle:function(e){var c=this.accessor(e);c.index in c.hostObj&&this.update(e,!c.hostObj[c.index],c);return this},pushStack:function(e){e.previous=this;return e},cd:function(e){return this.pushStack(j(this.getPath(e)))},parent:function(){return this.cd("..")},shadow:function(){return this.cd("*")},sibling:function(e){return this.cd(".."+e)},main:function(){return this.pushStack(j(Xb(this.path)))},getPath:function(e){return I(this.path,e)},logicalPath:function(e){return O(this.getPath(e))},
physicalPath:function(e){return L(this.getPath(e))},pathContext:function(){return ac(this.path)},pathIndex:function(){var e=Md.exec(this.path);return e[1]||e[0]},invoke:function(e){if(0===arguments.length)throw"methodName is missing";var c=this.get();return c[e].apply(c,v.call(arguments,1))},indexOf:function(e){return this.get().indexOf(e)},contains:function(e){return-1!==this.indexOf(e)},first:function(e){return e?this.filter(e)[0]:this.get("0")},last:function(){var e=this.get();return e[e.length-
1]},push:function(e){return this.create(this.get().length,e)},pushRange:function(e){for(var c=0;c<e.length;c++)this.push(e[c]);return this},pushUnique:function(e){return!this.contains(e)?this.push(e):this},pop:function(){return this.removeAt(this.get().length-1)},shift:function(){return this.del(0)},unshift:function(e){return this.create(0,e)},insertAt:function(e,c){return this.create(e,c)},updateAt:function(e,c){return this.update(e,c)},removeAt:function(e){return this.del(e)},move:function(e,c){var a=
this.count();e!==c&&(0<=e&&e<a&&0<=c&&c<a)&&(a=this.del(e),this.insertAt(c,a),x(this.path,this.path,"move",c,e));return this},replaceItem:function(e,c){if(e==c)return this;var a=this.indexOf(e);return-1!=a?this.updateAt(a,c):this},removeItem:function(e){e=this.indexOf(e);return-1!==e?this.removeAt(e):this},removeItems:function(e){for(var c=0;c<e.length;c++)this.removeItem(e[c]);return this},clear:function(){var e=this.get(),c=e.splice(0,e.length);x(this.path,this.path,"afterCreate",e,c);return this},
count:function(){return this.get().length},filter:function(e){return g(this.get()).filter(e).get()},each:function(e,c){wa(e)||(c=e,e=!1);var a,b,d,f;if(e){f=this.get();for(b=f.length-1;0<=b;b--)if(d=c(b,f[b],f),!0===d)a=!0;else if(!1===d)break;a&&this.triggerChange()}else for(b=this.count()-1;0<=b&&!(a=this.cd(b),!1===c.call(a,b,a,this));b--);return this},map:function(e){return g.map(this.get(),e)},sort:function(e,c){return x(this.path,this.path,"afterUpdate",this.get().sortObject(e,c))},reference:function(){for(var e=
0;e<arguments.length;e++)Zb(this.path,arguments[e]);return this},dereference:function(){for(var e=0;e<arguments.length;e++)$b(this.path,arguments[e]);return this},isEmpty:function(e){e=this.get(e);return!e?!0:!z(e)?!1:0===e.length},isShadow:function(){return this.path.startsWith(K)},toJSON:function(e){return JSON.stringify(this.get(e))},compare:function(e){if(e)if(e=Ia(e),n(e)){if(this.get()==e)return!0;try{return eval("this.get()"+e)}catch(c){return!1}}else return this.get()==e;else return this.isEmpty()},
saveLocal:function(e){Q.local(this.getPath(e),this.get());return this},getLocal:function(e){return Q.local(this.getPath(e))},restoreLocal:function(e){r.set(this.getPath(e),this.getLocal(e));return this},clearLocal:function(e){Q.local(this.getPath(e),q);return this}};var ha=[function(e,c,a){if(t(a)&&(!a.name||!a.name.startsWith("_"))){c=e?e+"."+c:c;var b=a.toString(),d;for(a=[];d=Ed.exec(b);)a.pushUnique(d[2]);for(b=0;b<a.length;b++)Zb(c,e?I(e,a[b]):a[b])}}],la={},Hb=function c(a){var b;if(!(this instanceof
c))return b=new c(la),c.apply(b,arguments);if(arguments[0]===la)return this;this.initialize.apply(this,arguments);return this},ya;m(Hb.prototype,{callProto:function(c){return this.constructor.prototype[c].apply(this,v.call(arguments,1))},callBase:function(c){ya=ya||this;if(ya=ya.constructor.__super__){var a=ya[c].apply(this,v.call(arguments,1));ya=null;return a}},initialize:function(c){m(this,c)},toJSON:function(){var c=m(!0,{},this),a;for(a in c)a.startsWith("__")&&delete c[a];return c}});m(Hb,{list:function(c){var a,
b,d=[],f;if(!k(c))if(z(c)){f=c.itemIsObject;for(a=0;a<c.length;a++)b=c[a],d.push(f||!z(b)?new this(b):this.apply(null,b))}else d.push(c);return d},extend:function(c,a){var b,d=this;b=c&&c.hasOwnProperty("constructor")?c.constructor:function w(){var a;if(!(this instanceof w))return a=new w(la),w.apply(a,arguments);if(arguments[0]===la)return this;d.apply(this,arguments);return this};m(b,d,a);var f=function(){this.constructor=b};f.prototype=d.prototype;b.prototype=new f;c&&m(b.prototype,c);b.__super__=
d.prototype;return b}});m(j,{Class:Hb,util:Q={toPhysicalPath:L=function(c,a){for(var b,d="",f="",h;b=Kd.exec(c);)c=A.rightContext,f=A.leftContext,"."==b[0]?d?(d==K&&(a&&!X[f])&&(h=f.replace(mb,nb),k(r.get(h))||(X[f]={})),d=d+"."+f):d=f:(d?(b=(d?d.replace(Ld,ed):d)+"#"+f,h=d+"."+f):h=f?b=f:b="",d=K+(b?"."+b:""),a&&(!X[b]&&d!=K&&!k(r.get(h)))&&(X[b]={}));return!c?d:d?d+"."+c:c},toLogicalPath:O=function(c){var a;return c===K?"*":(a=Yb.exec(c))?(c=A.rightContext,a=a[1].replace(mb,nb),O(a+"*"+c)):c},mergePath:I=
function(c,a,b){if("_"==a)return"_";if("_"==c)if(a&&a.startsWith("/"))c="";else return"_";c=L(c);if(!k(a)&&null!==a&&(a+="",a.startsWith("/")))return a.substr(1);k(b)&&(b=!0);b&&(a&&c&&!Oc.test(a))&&(a="."+a);if(!a||"."==a)return c;if(Oc.test(a)){if(b=Id.exec(a)){a=1+(b[1]?b[1].length:0);for(var d=A.rightContext;a;)c=ac(c),a--;return d?c?c+b[2]+d:d:"*"===b[2]?c+"*":c}if(b=Jd.exec(a))return I(Xb(c),b[1])}else return a;return c+a},isUndefined:k=function(c){return c===q},isPrimitive:R=function(c){return null===
c||typeof c in Dd},isString:n=function(c){return"string"===typeof c},isObject:s=function(c){return"object"===g.type(c)},isBoolean:wa=function(c){return"boolean"===typeof c},toTypedValue:Ia=function(c){if(n(c)){c=g.trim(c);try{c="true"===c?!0:"false"===c?!1:"null"===c?null:"undefined"===c?q:Fb(c)?parseFloat(c):Hd.test(c)?g.parseJSON(c):c}catch(a){}}return c},isPromise:aa=function(c){return!(!c||!c.promise||!c.done||!c.fail)},clearObj:Gb=function(c){if(R(c))return null;for(var a in c)Fd.call(c,a)&&
(c[a]=Gb(c[a]));return c},clone:xa=function(c,a){return R(c)?c:z(c)?c.slice(0):t(c)?c:m(!!a,{},c)},local:function(c,a){if(1==arguments.length)return JSON.parse(Db.getItem(c));k(a)?Db.removeItem(c):Db.setItem(c,JSON.stringify(a))},toString:function(c){return null===c||c===q?"":""+c},encodeHtml:function(c){var a=F.createElement("div");a.appendChild(F.createTextNode(c));return a.innerHTML},_referenceTable:S},onAddOrUpdateNode:function(c){return c?(ha.push(c),this):ha},onDeleteNode:function(c){return c?
(gb.push(c),this):gb},options:p});var gb=[function(c){var a,b,d=O(c);for(a in S)$b(c,a);for(a in S)a.startsWith(c)&&delete S[a];for(b in X)c=K+"."+b,a=O(c),(a==d||a.startsWith(d+"*")||a.startsWith(d+"."))&&r.del(c)}];g(["get","set","del","extend"]).each(function(c,a){j[a]=function(){return r[a].apply(r,v.call(arguments))}});r=j();na.hmData=function(c,a){var b=this.data("hmData");if(0===arguments.length)return b;if(1===arguments.length)return b&&b[c];k(b)&&this.data("hmData",b={});b[c]=a};var ba,ja=
/[ ]+/,fc=/\*\.$/,hd=/\.|\*/g,J,Od=0,Pd=/init(\d*)/,Ua=["get","set","convert","finalize","initialize"];Ra.prototype={constructor:Ra,isDependent:function(){return!this.publisher.path.startsWith(this.originalPublisher.path)},stopPropagation:function(){this.isPropagationStopped=H},stopImmediatePropagation:function(){this.isCascadeStopped=this.isPropagationStopped=this.isImmediatePropagationStopped=H},stopCascade:function(){this.isCascadeStopped=H},error:function(){this.hasError=H},isCascadeStopped:Qa,
isPropagationStopped:Qa,isImmediatePropagationStopped:Qa,hasError:Qa,level:0};x=function(c,a,b,d,f){d=new Ra(c,a,b,d,f);ec(d);if(!d.isPropagationStopped()&&d.publisher.path){d.isDependent()&&(d.originalPublisher.path=d.publisher.path);do d.publisher.path=d.publisher.pathContext(),d.level++,d.type=d.originalType+"."+d.level,ec(d);while(!d.isPropagationStopped()&&d.publisher.path)}d.type=b;d.originalPublisher.path=a;d.publisher.path=c;return d};var Ib=function(c,a){n(c)&&(c=L(c));for(var b=[],d=0,f;d<
ea.length;d++)f=ea[d],a(f,c)&&b.push(f);return b},ea=[];J={getByPublisher:function(c){return Ib(c,function(a,b){return a.publisher==b})},getBySubscriber:function(c){return Ib(c,function(a,b){return a.subscriber==b})},getBy:function(c){return Ib(c,function(a,b){return a.subscriber==b||a.publisher==b})},getAll:function(){return ea},add:function(c,a,b,d){if(n(a))for(var f=b.split(ja),h=0;h<f.length;h++){var g=this.special[f[h]];g&&g.setup&&g.setup(c,a)}ea.push({publisher:a,subscriber:c,eventTypes:b,
workflow:d})},removeBy:function(c){var a,b,d,f=[];for(a=ea.length-1;0<=a;a--)if(d=ea[a],b=d.workflow,c===d.publisher||c===d.subscriber||n(c)&&(n(d.publisher)&&d.publisher.startsWith(c+".")||n(d.subscriber)&&d.subscriber.startsWith(c+".")))n(d.publisher)||(b.delegateSelector?g(d.publisher).undelegate(b.delegateSelector,d.eventTypes,ma):g(d.publisher).unbind(d.eventTypes,ma)),f.push(ea.splice(a,1)[0]);for(a=f.length-1;0<=a;a--)if(d=f[a],n(d.publisher)){var h=d.eventTypes.split(ja);for(c=0;c<h.length;c++)(b=
this.special[h[c]])&&b.teardown&&b.teardown(d.subscriber,d.publisher)}},special:{}};m(j,{trigger:x,subscription:J,sub:function(c,a,b,d,f,h){c instanceof j&&(c=c.path);a instanceof j&&(a=a.path);n(c)&&c.startsWith("$")&&(c=g(c.substr(1)));if(c&&c.jquery)if(!c.length&&!c.selector)c=null;else{c.each(function(c,g){j.sub(g,a,b,d,f,h)});return}n(a)&&a.startsWith("$")&&(a=g(a.substr(1)));if(a&&a.jquery)a.each(function(a,g){j.sub(c,g,b,d,f,h)});else{if(!a&&""!==a)throw"publisher can not be null";if(!b)throw"eventTypes can not be null";
if("_"===c||"null"==c||null===c)c=q;"_"===f&&(f=q);var w=n(a),u=n(c);ia.mark(a);ia.mark(c);w&&(a=L(a));u&&(c=L(c));if(w){var k=a,l=b,m=c,w=f,B,r,t,p;p=l.split(" ");for(var s=0;s<p.length;s++)if(u=Pd.exec(p[s])){r=p[s];B=+u[1];p.splice(s,1);l=p.join(" ");break}t=gc(d,k,m,w);l&&J.add(m,k,l,t);r&&(l=function(){var a=new Ra(k,k,r);Sa(T(m),t,a)},B?P(l,B):l())}else B=a,w=b,u=c,p=f,s=w.split(" "),s.contains("init")&&(l=!0,w=s.remove("init").join(" ")),s=gc(d,B,u,p),p={workflow:s,subscriber:u},w?(w=dc(w,
B,u),h?(s.delegateSelector=h,g(B).delegate(h,w,p,ma)):g(B).bind(w,p,ma),J.add(u,B,w,s),l&&(h?g(B).find(h).trigger(w):g(B).trigger(w))):l&&(g(B).one("init",p,ma),g(B).trigger("init"))}},handle:function(){return this.sub.apply(this,[null].concat(v.call(arguments)))},workflowType:function(c,a){if(s(c))for(var b in c)ba[b]=hc(c[b]);else{if(k(c))return ba;if(k(a))return ba[c];ba[c]=hc(a);return ba[c]}},activity:{initialize:{},get:{getMember:bc,getOriginal:function(c){return c.originalPublisher.get()},
fakeGet:function(){return la}},set:{setMember:cc,fakeSet:g.noop},convert:{toString:Q.toString,toTypedValue:Q.toTypedValue,toNumber:function(c){return+c},toDate:function(c){return new Date(c)}},finalize:{}}});ba={triggerChange:{get:function(c){r.triggerChange(c.workflow.options)}},saveLocal:{get:function(c){var a=c.publisher.path;P(function(){j(a).saveLocal()},1)}}};var ia={getId:function(c){return g(c).hmData("viewId")},unMark:function(c){g(c).hmData("viewId",q)},mark:function(c){s(c)&&!g(c).hmData("viewId")&&
g(c).hmData("viewId",++Od)}};j.onDeleteNode(ic);m(M,{trigger:function(c,a,b,d){if(!arguments.length)throw"missing arguments";3>=arguments.length&&(d=b,b=a,a=c,c="");var f=this.physicalPath(c);x(f,f,a,b,d);return this},triggerChange:function(c){var a=this.physicalPath(c);c=this.get(c);x(a,a,"afterUpdate",c,c);return this},sub:function(c,a,b,d,f){j.sub(this.path,c,a,b,d,f);return this},handle:function(c,a,b,d){j.sub(null,this,c,a,b,d);return this},subBy:function(c,a,b,d,f){j.sub(c,this.path,a,b,d,f);
return this},subsToMe:function(){return J.getByPublisher(this.path)},subsFromMe:function(){return J.getBySubscriber(this.path)},subs:function(){return J.getBy(this.path)},mapEvent:function(c,a,b){b=b||H;j.handle(this.path,c,function(c){b.call(this,c)&&c.publisher.trigger(a,c.proposed,c.removed)});return this},cacheable:function(c){j.handle(this.getPath(c),"init after*","*saveLocal");return this}});m(na,{sub:function(c,a,b,d,f){this.length&&j.sub(this,c,a,b,d,f);return this},handle:function(c,a,b,
d){this.length&&j.sub(null,this,c,a,b,d);return this},subBy:function(c,a,b,d,f){this.length&&j.sub(c,this,a,b,d,f);return this},subsToMe:function(){return J.getByPublisher(this[0])},subsFromMe:function(){return J.getBySubscriber(this[0])},subs:function(){return J.getBy(this[0])},initView:function(c,a,b){j.sub(this,c,"init",a,b);return this},mapEvent:function(c,a,b,d){b?t(b)||(d=b,b=H):b=H;return this.handle(c,function(c){b.call(this,c)&&(c.type=a,c.eventData=d,c.publisher.trigger(c))})}});j.newViewEvent=
function(c,a,b){if(s(c)){for(var d in c)j.newViewEvent(d,c[d][0],c[d][1]);return this}var f=function(a){(!0===b||b.call(this,a))&&g(a.target).trigger(m({},a,{type:c,currentTarget:a.target}))};if(g.event.special[c])throw"event '"+c+"' has been defined";g.event.special[c]={setup:function(){g(this).bind(a,f)},teardown:function(){g(this).unbind(a,f)}};return this};var Qd=g.cleanData;g.cleanData=function(c){g(c).each(function(){ic(this)});Qd(c)};Q.getUniqueViewEventTypes=dc;Q._viewHandlerGateway=ma;var ld=
/([!$]?)([\w \+\-\*\.]+?):([\w\W]+?)\s*(?:[;]\s*|$)/g,Rd=/^([^|]+)(\|(.*))?$/,Sd=/\s*\|\s*/g;p.subsAttr="data-sub";p.autoparseSub=!0;var id=/-/g,jd=/-(\w)/g,kd=function(c,a){return a.toUpperCase()};ca.prototype={importBehaviors:function(){var c,a,b,d,f=this.behaviors;for(c=0;c<f.length;c++)b=f[c],a=b.behaviorName,d=Rd.exec(b.value),b=d[1],d=d[3],a=j.behavior[a],t(a)?a(this.elem,I(this.ns,b),this,pb(this.options,d)):n(a)&&new ca(a,this,b,d)},importSubscriptions:function(c){var a,b,d,f,h,g=this[c];
for(a=0;a<g.length;a++)b=g[a],f=b.eventTypes,b=b.value.split(Sd),"sub"==c?(d=b[0],d=d.startsWith("$")?d:I(this.ns,d),h=this.elem):(d=this.elem,h=b[0],h=h.startsWith("$")?h:I(this.ns,h)),this.appendSub(h,d,f,b[1],Ia(pb(this.options,b[2])),b[3])},appendSub:function(c,a,b,d,f,h){this.subscriptions.push({publisher:a,eventTypes:b,subscriber:c,handler:d,options:f,delegate:h})},prependSub:function(c,a,b,d,f,h){this.subscriptions.unshift({publisher:a,eventTypes:b,subscriber:c,handler:d,options:f,delegate:h})},
clearSubs:function(){this.subscriptions.splice(0,this.subscriptions.length)}};P(function(){g(function(){p.autoparseSub&&qb(F.documentElement)})},1);na.importBehaviors=function(){return this.each(function(){qb(this)})};var Pc=j("*log",[]);m(j,{behavior:Wa,log:function(c,a){Pc.push(a?"<div style='color:"+a+"'>"+c+"</div> ":c)},clearlog:function(){Pc.clear()}});Wa({init:function(c,a,b,d){r.get(a,c,a,b,d)},preImport:function(c,a,b,d){b.preImport=function(){r.get(a,c,a,b,d)}},postImport:function(c,a,b,
d){b.postImport=function(){r.get(a,c,a,b,d)}}});var C,Xa={},rb={initialize:"*templateOptions",get:"get",convert:"*dataToMarkup",set:"html",finalize:"*importBehaviors"};j.activity.initialize.templateOptions=function(c,a,b,d){if(n(d))d=d.split(","),b.templateId=g.trim(d[0]),b.wrapDataInArray="true"==g.trim(d[1]),b.engineName=d[2];else if(s(d)&&d.templateId)m(b,d);else if(!(b.templateId=a.hmData("embeddedTemplate")))if(c=g.trim(a.html()))c=c.replace(Td,Ud),b.templateId="__"+g.uuid++,C.compile(b.templateId,
c),a.hmData("embeddedTemplate",b.templateId),a.empty();else throw"missing template";};var Td=/&lt;|&gt;/g,Vd={"&lt;":"<","&gt;":">"},Ud=function(c){return Vd[c]||""};kc.prototype.get=function(){var c=this.e.publisher;return c.get.apply(c,v.call(arguments))};j.activity.convert.dataToMarkup=function(c,a){if(c&&(z(c)&&c.length||!z(c))){var b=a.workflow,d;var f=b.templateId,h=b.wrapDataInArray?[c]:c;d=new kc(a);var j=lc(b.engineName,f),f=g.trim(f);if(j.isTemplateLoaded(f))d=j.render(f,h,d);else if(j.renderAsync)d=
j.renderAsync(f,h,d);else{var u=g.Deferred(),b=m(!0,{},d.e),k=m(!0,{},b.publisher),l=m(!0,{},d);b.publisher=k;l.e=b;C.load(f).done(function(){var a=j.render(f,h,l),b=g(a);u.resolve(b.selector||!b.length?a:b)});d=u.promise()}if(aa(d))return d;n(d)&&(d=g.trim(d));return g(g("<div />").html(d)[0].childNodes)}return""};j.activity.finalize.importBehaviors=function(c){g(c).importBehaviors()};j.workflowType({renderContent:rb,replace:oa("get","replaceWith")});m(j.behavior,{include:"!init:.|*renderContent",
includeOnSelfChange:"!init after*.:.|*renderContent",includeOnChildChange:"!init after*. after*.1:.|*renderContent",includeOnAnyChange:"!init after*:.|*renderContent",replace:"!init:.|*replace"});na.renderContent=function(c,a,b){a=a||"";t(b)&&(b={finalize:b});return this.initView(a,b?m({},rb,b):"*renderContent",c)};na.replace=function(c,a,b){t(b)&&(b={finalize:b});return this.initView(a,b?m({},j.workflowType("replace"),b):"*replace",c)};j.template=C={defaultEngine:"",engineAdapter:function(c,a){if(!c)return Xa;
if(!a)return Xa[c];a.isTemplateLoaded=a.isTemplateLoaded||H;Xa[c]=a;C.defaultEngine=c},load:function(){throw"not implemented";},compile:function(c,a,b){return lc(b).compile(c,a)},newTemplateWorkflow:oa};if(g.render&&g.templates){var Jb;C.engineAdapter("jsrender",Jb={render:function(c,a,b){g.render[c]||this.compile(c,F.getElementById(c).innerHTML);return g.render[c](a,b)},compile:function(c,a){g.templates(c,{markup:a,debug:Jb.templateDebugMode,allowCode:Jb.allowCodeInTemplate})},isTemplateLoaded:function(c){return!!g.render[c]||
!!F.getElementById(c)},templateDebugMode:!1,allowCodeInTemplate:!0});var Qc=g.views.tags;Qc({ts:function a(){return a.enabled?"<span style='color:red' data-sub='show:/*ts'>updated on:"+(+new Date+"").substring(7,10)+"</span>":""},indexToNs:function(){var a=this.tagCtx.view.index,b=this.ctx.modelPath;k(a)&&(a=this.ctx.e.publisher.count()-1);return"ns:/"+b+"."+a},get:function(){var a=this.ctx.e.publisher;return a.get.apply(a,v.call(arguments))},prop:function(){var a=this.tagCtx.view.index;k(a)&&(a=
this.ctx.e.publisher.count()-1);a=this.ctx.e.publisher.cd(a);return a.get.apply(a,v.call(arguments))},keyToNs:function(){return"ns:/"+this.ctx.modelPath+".table."+this.ctx.e.publisher.itemKey(this.tagCtx.view.data)},dataPathAsNs:function(){return"ns:/"+this.ctx.modelPath}});Qc.ts.render.enabled=!0;j("*ts",!1)}var G=y.Handlebars;k(G)||(j.template.engineAdapter("handlebars",{render:function(a,b,d){return G.partials[a](b,{data:{renderContext:d}})},compile:function(a,b){G.registerPartial(a,G.compile(b))},
isTemplateLoaded:function(a){return!!G.partials[a]}}),G.registerHelper("modelPath",function(a){return a.data.renderContext.modelPath}),G.registerHelper("indexToNs",function(a){return"ns:/"+a.data.renderContext.modelPath+"."+a.data.index+";"}),G.registerHelper("keyToNs",function(a){a=a.data.renderContext;return"ns:/"+a.modelPath+".table."+a.e.publisher.itemKey(this)}),G.registerHelper("get",function(){var a=arguments,b=a.length-1,d=a[b].data.renderContext;return d.get.apply(d,v.call(a,0,b))}),G.registerHelper("prop",
function(){var a=[].slice,b=arguments,d=b.length-1,f=b[d].data,f=f.renderContext.e.publisher.cd(f.index);return f.get.apply(f,a.call(b,0,d))}),g(function(){g("script[type=handlebars]").each(function(){G.registerPartial(this.id,G.compile(g(this)[0].innerHTML))})}));var pa=[{name:"textBoxOrDropDown",get:function(a){return a.val()},set:function(a,b){a.val()!==b&&a.val(b)},match:H},{name:"checkbox",get:mc,set:function(a,b){var d=a[0];d.checked=wa(b)?b:b==d.value},match:function(a){return a.is(":checkbox")}},
{name:"radio",get:mc,set:function(a,b,d){a=a[0];a.name||(a.name=d.publisher.path);a.checked=Q.toString(b)==a.value},match:function(a){return a.is(":radio")}},{name:"listBox",get:function(a){var b=[];a.children("option:selected").each(function(){b.push(this.value)});return b},set:function(a,b){function d(){this.value==h&&(this.selected=!0)}a.children("option:selected").removeAttr("selected");for(var f=0,h;f<b.length;f++)h=b[f],a.children("option").each(d)},match:function(a){return a.is("select[multiple]")}}];
j.activity.get.getViewValue=function(a){return a.workflow.getViewValue(a.publisher)};j.activity.set.setViewValue=function(a,b){return b.workflow.setViewValue(this,a,b)};j.workflowType({updateViewValue:{initialize:function(a,b,d,f){nc(b,d,f,"set")},get:"get",set:"*setViewValue"},updateModelValue:{initialize:function(a,b,d,f){nc(a,d,f,"get")},get:"*getViewValue",set:"set"}});j.valueAdapter=function(a){if(a)pa.push(a);else return pa};j.behavior.val=function(a,b,d,f){var h,g,j;(f=f||"")?(f=f.split(","),
g=f[0]||"change",h=f[1],j=f[2]):g="change";(!h||"updateView"==h)&&d.appendSub(a,b,"init1 after*","*updateViewValue",j);(!h||"updateModel"==h)&&d.appendSub(b,a,g+" resetVal","*updateModelValue",j)};j.behavior.resetFormValues=function(a){function b(){d.find(":input").trigger("resetVal")}var d=g(a);d.bind("reset",function(){P(b,1)})};p.confirmMessage="Are you sure?";j.activity.get.compareTruthy=function(a){var b=a.workflow.options;a=a.publisher;return k(b)?!a.isEmpty():a.compare(b)};j.activity.initialize.extractClass=
function(a,b,d,f){a=f.split(",");d.className=a[0];d.options=a[1]};var Rc={options:["!init after*:.|*options",{get:function(a){var b=a.workflow.options,d=this.val();this.children("option[listItem]").remove().end().append(function(){var d="";g(a.publisher.get()).each(function(){d+="<option listItem='1' value='"+b.value(this)+"'>"+b.name(this)+"</option>"});return d}).val(d);this.val()!==d&&g(this.trigger("change"))},initialize:function(a,b,d,f){if(f){a=f.split(",");var h=a[0],g=a[1]||a[0];d.options=
{name:function(a){return a[h]},value:function(a){return a[g]}}}else d.options={name:function(a){return a.toString()},value:function(a){return a.toString()}}}}],show:["!init after*:.|*show",{get:"*compareTruthy",set:function(a){this[a?"show":"hide"]()}}],hide:["!init after*:.|*hide",{get:"*compareTruthy",set:function(a){this[a?"hide":"show"]()}}],enable:["!init after*:.|*enable",{get:"*compareTruthy",set:function(a){this.attr("disabled",!a)}}],disable:["!init after*:.|*disable",{get:"*compareTruthy",
set:function(a){this.attr("disabled",a)}}],addClass:["!init after*:.|*addClass",{initialize:"*extractClass",get:"*compareTruthy",set:function(a,b){this[a?"addClass":"removeClass"](b.workflow.className)}}],removeClass:["!init after*:.|*removeClass",{initialize:"*extractClass",get:"*compareTruthy",set:function(a,b){this[a?"removeClass":"addClass"](b.workflow.className)}}],toggleClass:["!init after*:.|*toggleClass",{get:function(a){var b,d,f=a.publisher.get(),h=a.workflow.options;h&&(h.startsWith("!")&&
(d=!0,h=h.substr(1)),b=f^d?"addClass":"removeClass");if("init"==a.type)if(h)this[b](h);else this.addClass(f);else if(h)this[b](h);else this.removeClass(a.removed).addClass(f)}}],focus:["!init after*:.|*focus",{get:"*compareTruthy",set:function(a){if(a){var b=this;P(function(){b.focus().select()},1)}}}],count:["!init after*:.|*count",function(a){a=a.publisher.get();this.text("length"in a?a.length:a)}],dump:["!init *:.|*dump",function(a){a.type.startsWith("before")||this.html("<span style='color:red'>"+
a.publisher.path+" : "+a.publisher.toJSON()+"</span>")}],alert:["$click:.|*alert",function(a){Bd(k(a.workflow.options)?this.get():a.workflow.options)}],preventDefault:["$click:_|*preventDefault",function(a){a.preventDefault()}],stopPropagation:["$click:_|*stopPropagation",function(a){a.stopPropagation()}],confirm:[function(a,b,d,f){j.sub(b,a,"click","*confirm",f)},function(a){var b=k(a.workflow.options)?this&&this.get&&this.get()||p.confirmMessage:a.workflow.options;Cd(b)||(a.stopImmediatePropagation(),
a.preventDefault&&a.preventDefault())}],hardCode:["$click:.|*hardCode",{initialize:function(a,b,d,f){d.hardCode=Ia(f)},get:function(a){this.set(a.workflow.hardCode)}}],"0":["$click:.|*0",function(){this.set(0)}],emptyString:["$click:.|*empty",function(){this.set("")}],"null":["$click:.|*null",function(){this.set(null)}],"true":["$click:.|*true",function(){this.set(!0)}],"++":["$click:.|*++",function(){this.set(this.get()+1)}],"--":["$click:.|*--",function(){this.set(this.get()-1)}],"false":["$click:.|*false",
function(){this.set(!1)}],toggle:["$click:.|*toggle",function(){this.set(!this.get())}],sortItems:["$click:.|*sortItems",{initialize:function(a,b,d,f){f=(f||"")&&f.split(",");d.by=f[0];d.asc=!!f[1]},get:function(a){a=a.workflow;this.sort(a.by,a.asc);a.asc=!a.asc}}],clear:["$click:.|*clear",function(){this.clear()}],del:["$click:.|*del;confirm:_|_Do you want to delete this item?",function(){this.del()}]},hb;for(hb in Rc){var Sc=Rc[hb];j.behavior[hb]=Sc[0];j.workflowType(hb,Sc[1])}m(j.behavior,{caption:function(a,
b,d,f){g(a).prepend("<option value=''>"+(f||j.get(b))+"</option>")},autofocus:function(a){P(function(){g(a).focus()},1)},mapEvent:function(a,b,d,f){f=f.split(",");g(a).mapEvent(f[0],f[1],f[2])},mapClick:function(a,b,d,f){f=f.split(",");g(a).mapEvent("click",f[0],f[1])},logPanel:function(a,b,d){g(a).css("list-style-type","decimal").css("font-family","monospace, serif");d.appendSub(a,"*log","init",function(a){a=a.publisher.get();for(var b=0;b<a.length;b++)this.append("<li>"+a[b]+"</li>")});d.appendSub(a,
"*log","afterCreate.1",function(a){this.append("<li>"+a.originalPublisher.raw()+"</li>")});d.appendSub(a,"*log","afterCreate",function(){this.empty()})},clearlog:"clear:/*log",enableLater:"!after*:.|*enable",disableLater:"!after*:.|*disable",html:"!init after*:.|get html *toString",text:"!init after*:.|get text *toString",removeIfDel:"!duringDel:.|*fakeGet remove",emptyIfDel:"!duringDel:.|*fakeGet empty"});j.newViewEvent({enter:["keyup",function(a){return 13===a.keyCode}],esc:["keyup",function(a){return 27===
a.keyCode}],ctrlclick:["click",function(a){return a.ctrlKey}]});var Wd={create:"POST",update:"PUT",destroy:"DELETE",fetch:"GET"},D={detached:0,unchanged:1,added:3,deleted:4,modified:5};j.onAddOrUpdateNode(function(a,b,d){d instanceof j.Entity&&(d.__state===D.detached&&(d.__state=D.added),k(j(a).get("__entityContainer"))&&(j.sub(a,a,"afterUpdate.*",md),j(a).set("__entityContainer",!0)))});j.Entity=j.Class.extend({__state:D.detached,create:function(){if(this instanceof j){if(this.get("__state")==D.added)return Ya(this,
"create");throw"entity is not a new item";}return this.constructor.create(this)},fetch:function(){return this instanceof j?Ya(this,"fetch"):this.constructor.fetch(this)},update:function(){if(this instanceof j){if(this.get("__state")==D.modified)return Ya(this,"update")}else return this.constructor.update(this)},destroy:function(){if(this instanceof j){var a=this;return Ya(this,"destroy").done(function(){a.del()})}return this.constructor.destroy(this)},save:function(){if(this instanceof j){var a=this.get("__state");
if(a==D.added)return this.get("create");if(a==D.modified)return this.get("update")}else throw"not supported";}},{state:D,create:function(a){return this.ajax("create",a)},update:function(a){return this.ajax("update",a)},destroy:function(a){return this.ajax("destroy",a)},fetch:function(a){if(a)return this.ajax("fetch",a);var b=this;return this.ajax("fetch").pipe(function(a){return g(b.list(a)).each(function(){this.__state=D.unchanged}).get()})},getUrl:function(a,b){var d=this.url||b.url,f=b&&b.id;return f?
d+("/"===d.charAt(d.length-1)?"":"/")+encodeURIComponent(f):d},ajax:function(a,b){var d=Wd[a],d={type:d,dataType:"json",url:this.getUrl(a,b),contentType:"GET"==d?null:"application/json",processData:!1,data:"GET"==d?null:JSON.stringify(b)};return g.ajax(d).done(function(a){b&&m(b,a)})}});m(M,{save:function(){return this.get("save")},destroy:function(){return this.get("destroy")},fetch:function(){return this.get("fetch")}});p.errors={defaultError:"Please enter a valid value"};var Ca=X.invalidPaths=
[],Za=j("*invalidPaths"),qc=/^\s*$/,Tc=/^\d+$/,Xd=/Invalid|NaN/,Yd=/^(\/(\\[^\x00-\x1f]|\[(\\[^\x00-\x1f]|[^\x00-\x1f\\\/])*\]|[^\x00-\x1f\\\/\[])+\/[gim]*)(,(.*))*$/,Ja=/([^,]+)(,(.*))?/,Uc=/(\w+),(\w+)(,(.*))?/;j.validator=function(a){if(z(a)){for(var b=0;b<a.length;b++)j.validator(a[b]);return this}b=a.name;if(j.workflowType(b))throw"validator name '"+b+"' collide with name in hm.workflowTypes";a.error&&(p.errors[b]=a.error);var d="v_"+b;j.workflowType(d,nd(a));j.behavior[b]="!afterUpdate checkValidity:.|*"+
d};j.workflowType({checkValidity:function(a){j.checkValidity(this.path)||a.stopImmediatePropagation()},warn:function(a){a.publisher.isEmpty()?this.removeClass("error").next("span.error").remove():this.addClass("error").next("span.error").remove().end().after("<span class='error'>"+a.publisher.get()+"</span>")},renderErrorSummary:j.template.newTemplateWorkflow(function(a){return[a.publisher.getErrors()]})});m(j.behavior,{validator:function(a,b,d,f){if(!f)throw"missing validator path";f.startsWith("#")||
(f="#"+f);j(b).validator(f)},checkValidity:function(a,b,d){d.prependSub(b,a,"click","*checkValidity")},resetFormValidity:function(a,b,d){d.appendSub(b,a,"reset","*fakeGet resetValidity")},resetForm:"resetFormValidity:.;resetFormValues:.",resetValidity:"$click:.|*fakeGet resetValidity",warn:"!after*:*errors|*warn",warnSummary:"!afterUpdate* validityChecked:.|*renderErrorSummary;!validityReset:.|empty"});j.subscription.special.validityChanged={setup:function(a,b){var d=b+"*isValid";k(j.get(d))&&j.sub(b,
"*invalidPaths","!after*. after*.1",function(){var a=oc(b);j.get(d)!==a&&(j.trigger(b,b,"validityChanged",a,!a),j.set(d,a))})}};m(M,{checkValidity:function(a){a=this.getPath(a);rc(a,function(a){x(a,a,"checkValidity",r.get(a))});var b=oc(a);j.trigger(a,a,"validityChecked",b);return b},validator:function(a,b){var d,f;if(s(a))for(d in a)this.cd(d).validator(a[d]);else if(t(a)||n(a)&&a.startsWith("#"))n(a)&&(a=this.raw(a.substr(1))),j.handle(this.path,"afterUpdate* checkValidity",function(b){var d=b.publisher,
f=a.previousError;null===b.proposed||b.proposed===q||qc.test(b.proposed)?f&&(d.removeError(f),a.previousError=""):(b=a(d.get()),!1===b&&(b=p.errors.defaultError),n(b)?b!=f&&(d.addError(b),f||d.removeError(f),a.previousError=b):f&&(d.removeError(f),a.previousError=""))});else if(n(a))j.handle(this.path,"afterUpdate* checkValidity","*v_"+a,b);else if(z(a))for(d=0;d<a.length;d++)f=a[d],z(f)?this.validator(f[0],f[1]):this.validator(f);return this},resetValidity:function(){pc(this.path);R(this.get())||
rc(this.path,pc);j.trigger(this.path,this.path,"validityReset")},addError:function(a){this.createIfUndefined("*errors",[]).cd("*errors").pushUnique(a);Za.pushUnique(this.path);return this},removeError:function(a){var b=this.createIfUndefined("*errors",[]).cd("*errors");b.removeItem(a);b.isEmpty()&&Za.removeItem(this.path);return this},getErrors:function(){var a,b=this.path,d,f=[];for(a=0;a<Ca.length;a++)if(d=Ca[a],d==b||d.startsWith(b))f=f.concat(j.get(d+"*errors"));return f}});j.checkValidity=function(a){return r.checkValidity(a)};
j.onDeleteNode(function(a){Za.removeItem(a)});j.validator.defaultErrorBuilder=Z;j.validator.buildRegexFn=qa;j.validator([{name:"required",error:"This field is required.",isValid:H},{name:"email",error:"Please enter a valid email address.",isValid:qa(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i)},
{name:"url",error:"Please enter a valid URL.",isValid:qa(/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i)},
{name:"date",error:"Please enter a valid date.",isValid:function(a){return!Xd.test((new Date(a)).toString())}},{name:"dateISO",error:"Please enter a valid date (ISO).",isValid:qa(/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/)},{name:"number",error:"Please enter a valid number.",isValid:qa(/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/)},{name:"digits",error:"Please enter only digits.",isValid:qa(Tc)},{name:"creditcard",error:"Please enter a valid credit card number.",isValid:function(a){if(/[^0-9\-]+/.test(a))return!1;
var b=0,d=0,f=!1;a=a.replace(/\D/g,"");for(var h=a.length-1;0<=h;h--){d=a.charAt(h);d=parseInt(d,10);if(f&&9<(d*=2))d-=9;b+=d;f=!f}return 0===b%10}},{name:"minlength",error:"Please enter at least {minlength} characters.",isValid:function(a,b){return a.length>=b.minlength},initialize:function(a,b,d,f){var h;if(f&&(h=Ja.exec(f)))d.options={minlength:+h[1],error:h[3]};else throw"invalid options for minlength validator";},buildError:Z},{name:"maxlength",error:"Please enter no more than {maxlength} characters.",
isValid:function(a,b){return a.length<=b.maxlength},initialize:function(a,b,d,f){var h;if(f&&(h=Ja.exec(f)))d.options={maxlength:+h[1],error:h[3]};else throw"invalid options for maxlength validator";},buildError:Z},{name:"rangelength",error:"Please enter a value between {minlength} and {maxlength} characters long.",isValid:function(a,b){return a.length>=b.minlength&&a.length<=b.maxlength},initialize:function(a,b,d,f){var h;if(f&&(h=Uc.exec(f)))d.options={minlength:+h[1],maxlength:+h[2],error:h[4]};
else throw"invalid options for rangelength validator";},buildError:Z},{name:"min",error:"Please enter a value greater than or equal to {min}.",isValid:function(a,b){return a>=b.min},initialize:function(a,b,d,f){var h;if(f&&(h=Ja.exec(f)))d.options={min:+h[1],error:h[3]};else throw"invalid options for min validator";},buildError:Z},{name:"max",error:"Please enter a value less than or equal to {max}.",isValid:function(a,b){return a<=b.max},initialize:function(a,b,d,f){var h;if(f&&(h=Ja.exec(f)))d.options=
{max:+h[1],error:h[3]};else throw"invalid options for max validator";},buildError:Z},{name:"range",error:"Please enter a value between {min} and {max}.",isValid:function(a,b){return a>=b.min&&a<=b.max},initialize:function(a,b,d,f){var h;if(f&&(h=Uc.exec(f)))d.options={min:+h[1],max:+h[2],error:h[4]};else throw"invalid options for range validator";},buildError:Z},{name:"equal",error:"Please enter the same value again.",isValid:function(a,b){return r.get(b.comparePath)===a},initialize:function(a,b,
d,f){var h;if(f&&(h=Ja.exec(f)))b=a.cd(h[1]).path,d.options={comparePath:b,error:h[3]},a.sub(b,"afterUpdate",function(){this.isEmpty()||x(this.path,this.path,"checkValidity",this.get())});else throw"invalid options for equal validator";}},{name:"regex",error:"Please enter a value match with required pattern.",isValid:function(a,b){return b.regex.test(a)},initialize:function(a,b,d,f){var h;if(f&&(h=Yd.exec(f)))d.options={regex:eval(h[1]),error:h[5]};else throw"invalid options for regex validator";
}},{name:"fixedValue",error:'Please enter value "{fixedValue}"',isValid:function(a,b){return a==b.fixedValue},initialize:function(a,b,d,f){if(n(f)){if(a=/^(\w+)(,(.*))*$/.exec(f))d.options={fixedValue:Ia(a[1]),error:a[3]}}else if(s(f))d.options=f;else{if(k(f))throw"missing options in fixedValue validator";d.options={fixedValue:f}}},buildError:Z}]);var od=j.workflowType("v_required").get,Ka={},W={},La={},ib={},wb={},ub=F.createElement("a"),qd=/,/,pd=/\s+/g,sd=/\?/,Zd=/\.(\w+)$/,$d=/(.+)\.\w+$/,ab,
Vc,Kb,Y,V,rd=/^http[s]?:\/\/|^\//,wc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bb=wc.exec(E.href.toLowerCase())||[],sa="",Ea="v",xc,Lb=[],Mb=[],Nb=[],vb,Wc={},l=y.matrix=function(a,b,d){"boolean"!==typeof a&&(d=b,b=a,a=!1);if(b)return a=a&&!g.isReady,b=sc(b,d),a&&(g.holdReady(!0),b.done(function(){g.holdReady()})),b.done(ae).fail(be)},be=sb(Mb),ae=sb(Lb),ce=sb(Nb),Ob=g.Deferred().isResolved?function(a){return a.isResolved()}:function(a){return"resolved"==a.state()};g.extend(l,{unload:function(a,
b){var d,f;if(g.isFunction(a))b?Nb.remove(a):Nb.push(a);else if("string"===typeof a&&(a=U(a)),1!=a.length)for(d=0;d<a.length;d++)l.unload(a[d]);else if(d=a[0],(f=N(d))&&"staticLoaded"!=f.refCount){if(0===--f.refCount||b)(f=f.unload||ra(d).unload)&&f(d),N(d,q),(d=V(d))&&l.unload(d,b);ce()}},url:function(a,b){if("object"===typeof a)for(var d in a)l.url(d,a[d]);else if(b===q){if(1==arguments.length){if(Ka[a])return Ka[a];d=ra(a);return tb(d&&d.url?d.url(a):d&&d.fileExt?Vc(a)+"."+d.fileExt:a)}delete Ka[a]}else{d=
l.url(a);var f=tb(b);d!=f&&((d=N(a))&&Ob(d)?yc(a,function(){Ka[a]=f}):Ka[a]=f)}},require:V=function(a,b){if("object"===typeof a)for(var d in a)a.hasOwnProperty(d)&&V(d,a[d]);else if(b===q){if(1==arguments.length){d=La[a];var f=ra(a);return f&&f.require?(f=f.require(a))&&d?f+","+d:f?f:d:d}delete La[a]}else if(!0===b){if(d=(d=V(a))&&U(d)){for(var f=[],h=0;h<d.length;h++)"module"!==l.fileExt(d[h])&&f.pushUnique(l.url(d[h])),f.merge(V(d[h],!0));return f}}else{var g;d=b;if(h=(f=ra(a))&&f.require&&f.require(a)){f=
[];h=U(h);d=U(d);for(var j=0;j<d.length;j++)h.contains(d[j])||f.push(d[j]);g=f.length?f.join():null}else g=d;d=La[a];td(g,d)&&(f=N(a),d&&f&&Ob(f)?yc(a,function(){La[a]=g}):La[a]=g)}},baseUrl:"",hash:function(a,b){arguments.length&&(sa=!0===a?g.now():a,Ea=b!==q?b:Ea||"v",xc=new A("[?&]"+Ea+"=[^&]*"));return""===sa?"":Ea+"="+sa},loader:{resolveDependencies:function(a){return function(b){var d=g.Deferred(),f=l.require(b);f?l(f).done(function(){d.resolve(b,a(b))}):d.resolve(b,a(b));return d.promise()}},
set:function(a,b,d){"string"!==typeof b&&(d=b,b=null);d=ib[a]=g.extend(!0,{},ib[b],d);var f=g.extend(!0,{},d);g.each(["load","unload","url","require"],function(a,b){var d;if("string"==typeof f[b]&&(d=Kb[b][f[b]]))f[b]=d});if(g.isPlainObject(f.load)){d=f.load;for(var h in d)"string"==typeof d[h]&&(d[h]=Y[h][d[h]]);var j=d.staticLoaded||Y.staticLoaded.returnFalse,u=d.getSource||Y.getSource.getTextByAjax,k=d.compile||Y.compile.globalEval,q=d.crossSiteLoad||Y.crossSiteLoad.getScript,n=d.buildDependencies||
Y.buildDependencies.parseRequireTag,p=d.buildUnload||Y.buildUnload.parseUnloadTag;if(!k&&!q)throw"module loader must implement at least one of compile, crossSiteLoad";f.load=function(a){var b=g.Deferred(),d=b.promise(),f;if(j(a))d.refCount="staticLoaded",b.resolve(a);else{f=l.url(a);if(!k||vc(f)){if(!q)throw"loader does not support cross domain loading";if((f=q(a))&&f.done)return f;b.resolve(a,f)}else u(a).then(function(f){if(p){var g=p(f,a);g&&(N(a).unload=g)}n&&(g=n(a,f))&&V(a,g);var g=function(){var g=
k&&k(a,f);P(function(){b.dontResolve||(b.resolve(a,g),delete d.defer)},5)},h=V(a);h?l(h).then(g,function(){b.reject(a);delete d.defer}):g()},function(){b.reject(a);delete d.defer});Ob(b)||(d.defer=b)}return d}}if(!g.isFunction(f.load))throw"missing load function from loader";wb[a]=g.extend({},wb[b],f)},get:function(a){return a?ib[a]:ib},commands:Kb={load:{},unload:{},url:{},require:{}},finders:vb=[function(a){return ab(a)},function(a){a=ab(a);if(a=Wc[a])return a}],mapFileExtsToLoader:function(a,b){a=
U(a);for(var d=0;d<a.length;d++)Wc[a[d]]=b},loadFilters:Y={staticLoaded:{},getSource:{},compile:{},crossSiteLoad:{},buildUnload:{},buildDependencies:{}}},fileExt:ab=function(a){return Zd.exec(a)[1]},fileName:Vc=function(a){return $d.exec(a)[1]},define:function(a,b,d,f){g.isFunction(b)&&(f=d,d=b,b=null);var h=N(a);if(!h){var j=g.Deferred(),h=j.promise();h.defer=j;N(a,h)}h.defer.dontResolve=!0;if(b)return V(a,b),l(b).done(function(){zc(a,d,f)});zc(a,d,f)},done:function(a,b){b?Lb.remove(a):Lb.push(a)},
fail:function(a,b){b?Mb.remove(a):Mb.push(a)},defaultLoader:"js"});var Ma=l.loader.set,de=/<@unload>([\w\W]+?)<\/@unload>/i,ee=/<@require>([\w\W]+?)<\/@require>/i;g.extend(!0,Kb,{load:{cacheImage:function(a){var b=g.Deferred(),d=b.promise(),f=l.url(a),h=new Image,h=new Image;h.onload=function(){b.resolve(a,f)};h.onerror=function(){b.reject(a,f)};h.src=f;return d}},unload:{removeCssLinkTag:function(a){var b=tb(l.url(a));g("link").filter(function(){return this.href===b&&g(this).attr("loadedByMatrix")}).remove()}},
url:{moduleId:function(a){return a},folder:function(a){var b=ra(a).fileExt,b=b?l.fileName(a)+"."+b:a;return l.fileExt(a)+"/"+b}}});g.extend(!0,Y,{staticLoaded:{returnFalse:function(){return!1},hasScriptTag:function(a){return!!g("script").filter(function(){return Da(this.src)===Da(l.url(a))}).length},hasCssLinkTag:function(a){return!!g("link").filter(function(){return Da(this.href)===Da(l.url(a))&&!g(this).attr("loadedByMatrix")}).length}},getSource:{getTextByAjax:function(a){return g.ajax({url:l.url(a),
dataType:"text",cache:!0})}},compile:{globalEval:function(a,b){return g.globalEval(b)},localEval:function(a,b){return eval(b)},linkCss:Ac},crossSiteLoad:{getScript:function(a){var b=g.Deferred(),d=b.promise();d.defer=b;g.getScript(l.url(a)).then(function(){P(function(){b.dontResolve||(b.resolve(a),delete d.defer)},5)},function(){b.reject(a);delete d.defer});return d},linkCss:Ac},buildUnload:{parseUnloadTag:function(a){return(a=de.exec(a))&&a[1]&&new Function(a[1])}},buildDependencies:{parseRequireTag:function(a,
b){var d=ee.exec(b);return d&&d[1]||null}}});Ma("pack",{load:l.loader.resolveDependencies(g.noop),url:"moduleId"});Ma("js",{load:{staticLoaded:"hasScriptTag"},fileExt:"js"});Ma("loader","js",{url:"folder"});Ma("css",{load:{staticLoaded:"hasCssLinkTag",crossSiteLoad:"linkCss",compile:"linkCss",buildDependencies:"parseRequireTag"},unload:"removeCssLinkTag",fileExt:"css"});Ma("image",{load:"cacheImage",noRefCount:!0});l.loader.mapFileExtsToLoader("jpg,png,bmp,gif","image");C.load=function(a){return l(a.endsWith(".html")?
a:a+".template")};l.loader.set("template",{load:{compile:function(a,b){g(b).filter("script[id]").each(function(){var a=g(this);C.compile(this.id,a.html(),a.attr("type")||C.defaultEngine)})},buildDependencies:"parseDependsTag"},url:function(a){return C.templateIdToUrl(l.fileName(a))}});l.loader.set("html",{load:{compile:function(a,b){return C.compile(a,b,C.defaultEngine)}}});C.templateIdToUrl=function(a){var b;a.startsWith("*")?(a=a.substr(1),b=a.split("."),a="_",b=b[0]):(b=a.split("."),a=b[0],b=b[1]||
"main");return"template/"+a+"/"+b+".html"};j.workflowType({addRowView:oa("*getOriginal",function(a,b){var d=this.children();if(0===d.length)this.append(a);else{var f=+b.originalPublisher.pathIndex();0===f?d.eq(0).before(a):d.eq(f-1).after(a)}}),updateRowView:oa("*getOriginal",function(a,b){this.children().eq(+b.originalPublisher.pathIndex()).replaceWith(a)}),removeRowView:function(a){this.children().eq(+a.originalPublisher.pathIndex()).remove()}});M.initQueryable=function(a){function b(){var a=u.ops,
b=u.by,f=u.value,g;if(f){if(a)if("equals"==a)g=A("^"+f+"$","i");else throw"operator does not supported";else g=A(f,"i");j=b?function(){return g.test(this[b])}:function(){if(s(this)){for(var a in this)if(g.test(this[a]))return!0;return!1}return g.test(this)};r.set(!0);d.refreshQuery()}else j&&(j=null,r.set(!1),d.refreshQuery())}if(this.get("*query"))return this;var d,f,h,j,u,k=this.get(),l=this.cd("*query"),q=this.cd("*queryResult"),n=this.cd("*hasQueryResult"),p=l.cd("pager"),m=l.cd("filter"),r=m.cd("enabled"),
t=l.cd("sort");(a=!!a)&&q.reference(l.path);q.reference(this.path);this.extend("*",d={autoQuery:a,hasQueryResult:!1,query:{pager:h={enabled:!1,index:0,count:1,size:0},sort:f={by:null,asc:null},filter:u={by:"",value:"",ops:"",enabled:!1},enabled:function(){return this.get("pager.enabled")||this.get("sort.by")||this.get("filter.enabled")}},queryResult:function(a){var b=g(k),b=j?b.filter(j).get():b.get();n.update(0<b.length);f.by&&b.sortObject(f.by,f.asc);!a&&h.enabled&&(a=Math.ceil(b.length/h.size)||
1,a!=h.count&&(h.count=a,h.index>h.count-1&&(h.index=0),l.triggerChange("pager")),b=b.slice(h.index*h.size,(h.index+1)*h.size));return b},refreshQuery:function(){d.autoQuery||P(function(){q.trigger("afterUpdate")},0)},paging:function(a){a=a.eventData;Tc.test(a)?a=+a:"next"==a?a=h.index+1:"previous"==a?a=h.index-1:"first"==a?a=0:"last"==a?a=h.count-1:"disabled"==a&&(a=0,d.resetPaging());if("number"!==typeof a||0>a||a>h.count-1)a=0;p.update("index",a);d.refreshQuery()},resetSort:function(a){t.set("by",
null).set("asc",null);!0!==a&&d.refreshQuery()},resetSearch:function(a){m.update("by","").update("value","").update("ops","");!0!==a&&d.refreshQuery()},resetPaging:function(a){p.update("enabled",!1).update("size",0).update("count",1).update("index",0);!0!==a&&d.refreshQuery()},resetQuery:function(){d.resetSort(!0);d.resetSearch(!0);d.resetPaging(!0);d.refreshQuery()}});m.cd("by").handle("afterUpdate",b);m.cd("value").handle("afterUpdate",b);m.cd("ops").handle("afterUpdate",b);return this};j.behavior({listView:"includeOnSelfChange:.;!afterCreate.1:.|*addRowView;!afterUpdate.1:.|*updateRowView;!afterDel.1:.|*removeRowView",
initQueryable:function(a,b,d,f){j(b).initQueryable(!!f)},queryView:"includeOnAnyChange:*queryResult",sortQueryButton:"$click:*query.sort.by|*hardCode;$click:*query.sort.asc|*toggle;$click:*refreshQuery",resetSortButton:"$click:*resetSort;show:*query.sort.by",searchButton:"$click:*refreshQuery;enable:*query.filter.enabled",resetSearchButton:"$click:*resetSearch;show:*query.filter.enabled",resetQueryButton:"$click:*resetQuery;show:*query.enabled",searchBox:"ns:*query.filter.value;val:.|enter;$esc:.|*null",
pager:"includeOnAnyChange:*query.pager;show:*hasQueryResult|_;$paging:*paging;preventDefault:.",setPageButton:"true:*query.pager.enabled;enable:*query.pager.size;$click:*refreshQuery",page:function(a,b,d,f){if(!f)throw"pageIndex is missing";g(a).mapEvent("click","paging",f)},showFound:"show:*hasQueryResult",hideFound:"hide:*hasQueryResult"});j.onAddOrUpdateNode(function(a,b,d){if(z(d)){var f=d;k(f)?f=[]:z(f)||(f=[f]);if(!f.table||!f.guid)f.table={},f.guid=0;for(var f=f.table,g=0;g<d.length;g++)f["c"+
d.guid++]=d[g];a=j(a).cd(b);b=a.cd("table");b.sub(a,"afterCreate.1",vd);b.sub(a,"afterUpdate.*",ud);b.sub(a,"afterDel.1",wd);a.sub(b,"afterDel.1",xd);a.sub(b,"afterUpdate.1",yd)}});M.itemKey=function(a){var b,d;d=this.raw();t(d)&&(d=this.main().get());if(d=d.table)for(b in d)if(a===d[b])return b};M.keyAt=function(a){return this.itemKey(this.get(a))};g.Event.prototype.selectedRowIndex=function(){return this.publisher.children().filter(this.originalPublisher.parents()).index()};xb.prototype={item:null,
mode:function(){var a=this.get(),b=a.selectedIndex;return null===a.item?"read":k(b)?"update":-1==b?"new":"update"}};m(M,{initShadowEdit:function(a){var b=this;if(!b.get("*edit")){var d=b.path,f=A("^"+d.replace(".","\\.")+"\\*edit\\.item[^*]+\\*$"),g=A("^"+d.replace(".","\\.")+"\\*edit\\.item[\\w.]+\\*edit\\.item");if(k(a))if(b.isShadow()&&!t(b.raw())){a=b.main();var j=(a.logicalPath()+"*edit.item").length+1,d=O(d).substr(j);a=xa(a.get("*edit.itemTemplate."+d+".0"),!0)}else a=t(b.raw())?r.raw(b.main().path+
"_itemTemplate"):r.raw(d+"_itemTemplate"),k(a)&&(a=Gb(xa(b.get()[0],!0)));d=new xb(-1);d.itemTemplate=a;d.item=null;b.set("*edit",d);b.cd("*edit.selectedIndex").handle("afterUpdate",function(a){var d=a.proposed;a=a.removed;0<=d?b.trigger("beginInRowUpdate",d):-1==d&&b.trigger("cancelInRowUpdate",a)});b.cd("*edit.item").handle("afterUpdate",function(){var a,b;for(a in X)if(b=Q.toLogicalPath("__hm."+a),g.test(b))delete X[a];else if(f.test(b)&&(b=X[a].edit))b.item=null,b.selectedIndex=-1});return this}},
newShadowItem:function(){"read"!==this.get("*edit.mode")&&this.resetShadowItem();var a=this.cd("*edit"),b=a.raw("itemTemplate"),b=t(b)?b():xa(b,!0);a.update("item",b);a.triggerChange("mode")},editShadowItem:function(a,b){var d=this.raw();if(R(d)||s(d)){var f=this.get("*edit");k(f)&&(f=new xb,this.set("*edit",f));null===f.item&&(this.set("*edit.item",xa(d,!0)),this.triggerChange("*edit.mode"))}else"read"!==this.get("*edit.mode")&&this.resetShadowItem(),k(b)?b=this.indexOf(a):a=this.get()[b],d=this.cd("*edit"),
f=d.raw("itemTemplate"),f=t(f)?f(a):xa(a,!0),d.update("item",f).update("selectedIndex",b),d.triggerChange("mode")},resetShadowItem:function(a){if(this.path.endsWith(".edit.item"))return this.main().resetShadowItem();var b=this.raw();R(b)||s(b)?(this.set("*edit.item",null),this.triggerChange("*edit.mode")):(b=this.cd("*edit"),k(b.get())||(b.update("item",null),a?b.get().selectedIndex=-1:b.update("selectedIndex",-1),b.triggerChange("mode")))},saveShadowItem:function(){if(this.path.endsWith(".edit.item"))return this.main().saveShadowItem();
var a=this.raw();if(R(a)||s(a))this.set(this.get("*edit.item")).set("*edit.item",null),this.triggerChange("*edit.mode");else{var b=this.get("*edit.mode"),d=this.get("*edit.item");if("read"==b)throw"invalid operations";"new"==b?(t(a)?this.main().push(d):this.push(d),this.resetShadowItem()):(b=this.get("*edit.selectedIndex"),t(a)?(a=this.get(),this.main().replaceItem(a[b],d)):this.replaceItem(a[b],d),this.resetShadowItem(!0))}}});j.workflowType({newShadowItem:"*fakeGet newShadowItem",editShadowItem:function(a){"editRow"==
a.type?this.editShadowItem(null,a.selectedRowIndex()):this.path.endsWith(".edit.item")?this.main().editShadowItem(this.get()):this.editShadowItem();a.stopPropagation()},removeItem:function(a){"read"!=this.get("*edit.mode")&&this.resetShadowItem();var b=a.selectedRowIndex(),d=this.raw();t(d)?(d=this.get(),this.main().removeItem(d[b])):this.removeAt(b);a.stopPropagation()},moveUpItem:function(a){var b=a.selectedRowIndex();this.move(b,b-1);a.stopPropagation()},moveDownItem:function(a){var b=a.selectedRowIndex();
this.move(b,b+1);a.stopPropagation()},renderNewView:oa(function(a){if("new"==a.publisher.get())return a.publisher.main().get("*edit.item")}),renderUpdateRowView:oa(function(a){return a.publisher.get("*edit.item")},function(a,b){this.children().eq(b.proposed).replaceWith(a)}),destroyUpdateRowView:function(a){a.publisher.triggerChange(a.proposed)},saveShadowItem:function(a){this.saveShadowItem();a.stopPropagation()},resetShadowItem:function(a){this.resetShadowItem();a.stopPropagation()}});j.behavior({shadowEdit:"!init:.|initShadowEdit *fakeSet;deleteRow:.;$editRow:.|*editShadowItem",
shadowEditInRow:"shadowEdit:.;!beginInRowUpdate:.|*renderUpdateRowView;!cancelInRowUpdate:.|*destroyUpdateRowView",deleteRow:"$deleteRow:.|*confirm|_Do you want to delete this item?;$deleteRow:.|*removeItem;",movableRow:"$moveUp:.|*moveUpItem;$moveDown:.|*moveDownItem;",newItemView:"!afterUpdate:*edit.mode|*renderNewView;showOnNew:.",showOnNew:"show:*edit.mode|_new",hideOnNew:"hide:*edit.mode|_new",editItemView:"includeOnSelfChange:*edit.item;showOnEdit:.",displayItemView:"includeOnSelfChange:.;hideOnEdit:.",
showOnEdit:function(a,b,d){d.appendSub(a,b+"*edit.mode","init afterUpdate",function(a){a=a.publisher.get();this[k(a)||"read"==a?"hide":"show"]()})},hideOnEdit:function(a,b,d){d.appendSub(a,b+"*edit.mode","init afterUpdate",function(a){a=a.publisher.get();this[k(a)||"read"==a?"show":"hide"]()})},newItem:"$click:.|*newShadowItem;hideOnNew:.",editObject:"$click:.|*editShadowItem;hideOnEdit:.",saveButton:"$click:.|*saveShadowItem",cancelSaveButton:"$click:.|*resetShadowItem"});j.newViewEvent({editRow:["click",
function(a){return g(a.target).hasClass("editRow")}],deleteRow:["click",function(a){return g(a.target).hasClass("deleteRow")}],moveUp:["click",function(a){return g(a.target).hasClass("moveUp")}],moveDown:["click",function(a){return g(a.target).hasClass("moveDown")}]});var yb=decodeURIComponent,va=g.param,Dc,fa,$,Pb,Qb=g.bbq=g.bbq||{},Xc,Yc,Hc,jb=g.event.special,ua="querystring",da="fragment",Cc=/^.*\?|#.*$/g,db,cb,Ec,Zc,zb,fe={};va[ua]=ta(Bc,0,function(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,
"$1")});va[da]=fa=ta(Bc,1,function(a){return a.replace(cb,"$2")});va.sorted=Dc=function(a,b){var d=[],f={};g.each(va(a,b).split("&"),function(a,b){var g=b.replace(/(?:%5B|=).*$/,""),j=f[g];j||(j=f[g]=[],d.push(g));j.push(b)});return g.map(d.sort(),function(a){return f[a]}).join("&")};fa.noEscape=function(a){a=g.map((a||"").split(""),encodeURIComponent);Ec=new A(a.join("|"),"g")};fa.noEscape(",/");fa.ajaxCrawlable=function(a){a!==q&&(a?(db=/^.*(?:#!|#)/,cb=/^([^#]*)(?:#!|#)?(.*)$/,zb="#!"):(db=/^.*#/,
cb=/^([^#]*)#?(.*)$/,zb="#"),Zc=!!a);return Zc};fa.ajaxCrawlable(0);g.deparam=$=function(a,b){var d={},f={"true":!0,"false":!1,"null":null};g.each(a.replace(/\+/g," ").split("&"),function(a,j){var k=j.split("="),l=yb(k[0]),p=d,n=0,m=l.split("]["),r=m.length-1;/\[/.test(m[0])&&/\]$/.test(m[r])?(m[r]=m[r].replace(/\]$/,""),m=m.shift().split("[").concat(m),r=m.length-1):r=0;if(2===k.length)if(k=yb(k[1]),b&&(k=k&&!isNaN(k)?+k:"undefined"===k?q:f[k]!==q?f[k]:k),r)for(;n<=r;n++)l=""===m[n]?p.length:m[n],
p=p[l]=n<r?p[l]||(m[n+1]&&isNaN(m[n+1])?{}:[]):k;else g.isArray(d[l])?d[l].push(k):d[l]=d[l]!==q?[d[l],k]:k;else l&&(d[l]=b?q:"")});return d};$[ua]=ta(Fc,0);$[da]=Pb=ta(Fc,1);g.elemUrlAttr||(g.elemUrlAttr=function(a){return g.extend(fe,a)})({a:"href",base:"href",iframe:"src",img:"src",input:"src",form:"action",link:"href",script:"src"});Hc=g.elemUrlAttr;g.fn[ua]=ta(Gc,ua);g.fn[da]=ta(Gc,da);Qb.pushState=Xc=function(a,b){Fa(a)&&(/^#/.test(a)&&b===q)&&(b=2);var d=a!==q,d=fa(E.href,d?a:{},d?b:2);E.href=
d};Qb.getState=Yc=function(a,b){return a===q||"boolean"===typeof a?Pb(a):Pb(b)[a]};Qb.removeState=function(a){var b={};a!==q&&(b=Yc(),g.each(g.isArray(a)?a:arguments,function(a,f){delete b[f]}));Xc(b,2)};jb.hashchange=g.extend(jb.hashchange,{add:function(a){function b(a){var b=a[da]=fa();a.getState=function(a,d){return a===q||"boolean"===typeof a?$(b,a):$(b,d)[a]};d.apply(this,arguments)}var d;if(g.isFunction(a))return d=a,b;d=a.handler;a.handler=b}});var Rb,$c=F.documentMode,Sb="onhashchange"in y&&
($c===q||7<$c);g.fn.hashchange=function(a){return a?this.bind("hashchange",a):this.trigger("hashchange")};g.fn.hashchange.delay=50;jb.hashchange=g.extend(jb.hashchange,{setup:function(){if(Sb)return!1;g(Rb.start)},teardown:function(){if(Sb)return!1;g(Rb.stop)}});var Ub=function(){var a=Ga(),b=ad(kb);a!==kb?(Tb(kb=a,b),g(y).trigger("hashchange")):b!==kb&&(E.href=E.href.replace(/#.*/,"")+b);Na=P(Ub,g.fn.hashchange.delay)},Oa={},Na,kb=Ga(),Vb=function(a){return a},Tb=Vb,ad=Vb;Oa.start=function(){Na||
Ub()};Oa.stop=function(){Na&&clearTimeout(Na);Na=q};if(g.browser.msie&&!Sb){var za,Pa;Oa.start=function(){za||(Pa=(Pa=g.fn.hashchange.src)&&Pa+Ga(),za=g('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){Pa||Tb(Ga());Ub()}).attr("src",Pa||"javascript:0").insertAfter("body")[0].contentWindow,F.onpropertychange=function(){try{"title"===event.propertyName&&(za.document.title=F.title)}catch(a){}})};Oa.stop=Vb;ad=function(){return Ga(za.location.href)};Tb=function(a,b){var d=za.document,
f=g.fn.hashchange.domain;a!==b&&(d.title=F.title,d.open(),f&&d.write('<script>document.domain="'+f+'"\x3c/script>'),d.close(),za.location.hash=a)}}Rb=Oa;var eb=g.bbq,Ha=[],fb,bd,cd=[];j.bookmark=function(){var a,b,d=eb.getState(),f={};for(a=0;a<arguments.length;a++)b=arguments[a],b in d&&r.set(b,d[b]),j.sub(null,b,"afterUpdate",zd),cd.push(b),f[b]=r.get(b);Ab(g.param.fragment(E.href,f));return this};var Ab=Mc.replaceState?function(a){Mc.replaceState(null,null,a)}:function(a){E.href=a};M.bookmark=
function(a){var b=this;j.bookmark.apply(j,g.map(a?arguments:[""],function(a){return b.getPath(a)}));return b};j.route=function(a,b){Ha.push(a);b&&(fb=a);var d=Bb();Kc(d,a)&&(bd=!0)};g(y).bind("hashchange",function(){var a;a:{if(a=Bb())for(var b=0;b<Ha.length;b++)if(Kc(a,Ha[b])){a=!0;break a}a=void 0}a||Ic();a=eb.getState();for(var d in a)cd.contains(d)&&r.set(d,a[d])});g(function(){bd||Ic()});p.selectedClass="selected";p.tabViewAttr="data-tabView";p.tabLinkAttr="data-tabLink";p.tabGroupAttr="data-tabGroup";
j.workflowType({highlightTab:function(a){var b=this.attr(p.tabViewAttr)||this.attr(p.tabLinkAttr),d=a.workflow.options||p.selectedClass;a.publisher.get()==b?this.addClass(d):this.removeClass(d)},highlightTabInContainer:function(a){var b=a.publisher.get(),d=p.tabViewAttr,f=p.tabLinkAttr;a=a.workflow.options;var h=a.selectedClass||p.selectedClass;this.find(a.selector).andSelf().each(function(a,j){var k=g(j);(k.attr(d)||k.attr(f))==b?k.addClass(h):k.removeClass(h)})}});j.behavior.tab=function(a,b,d,
f){d.appendSub(a,b,"init afterUpdate","*highlightTab",f);g(a).attr(p.tabLinkAttr)&&d.appendSub(b,a,"click",Lc,p.tabLinkAttr)};j.behavior.tabContainer=function(a,b,d,f){f=(f||"").split(",");var g=p.tabLinkAttr,j=p.tabGroupAttr,k=f[0]?"["+j+"='"+f[0]+"']":"",j="["+g+"]"+k,k=j+",["+p.tabViewAttr+"]"+k;d.appendSub(b,a,"click",Lc,g,j);d.appendSub(a,b,"init100 afterUpdate","*highlightTabInContainer",{selector:k,selectedClass:f[1]})};var ga={},ge=/^([^,]+)(,(.+))?$/,dd=/^([^,]+)(,([^,]+))?(,(.+))?$/;j.App=
j.Class.extend({initialize:function(a){if(!a.name)throw"An app must have a name.";this.callBase("initialize",a)},bootstrap:function(a,b,d){if(a&&this.loadable()){var f=this,h,j=f.name;Aa.get(a,j)||(!1!==f.buildRootModel&&(h=f.buildRootModel(b,d)),aa(h)?h.done(function(){f.buildRootView(a,b)}):f.buildRootView(a,b),Aa.add(a,b,j,f),g(a).bind("shutdown."+j,function(a){f.shutdown(this,a.namespace);a.stopPropagation()}),f.instanceCount++,f.uid++)}},shutdown:function(a){var b=this.name,d=Aa.get(a,b);this.destroyRootView(a);
this.destroyRootModel(d.namespace);Aa.remove(a,b);g(a).unbind("shutdown."+b);this.instanceCount--},fetchRootData:null,buildRootModel:function(a,b){var d=this;if(!d.fetchRootData)throw"app.fetchRootData is not implemented";var f=d.fetchRootData(a,b);if(aa(f))return f.done(function(b){j.set(d.getNamespace(a),b)});j.set(d.getNamespace(a),f)},destroyRootModel:function(a){!1!==this.buildRootModel&&j.del(a)},buildRootView:function(a,b){var d=this.getNamespace(b),f=g("<div></div>").attr("appname",this.name);
f.hmData("ns",d);f.appendTo(g(a)).renderContent(this.getTemplateOptions(),d)},destroyRootView:function(a){g(a).find("> [appname='"+this.name+"']").remove()},getTemplateOptions:function(){return this.templateOptions||this.name},getNamespace:function(a){var b=this.subPath||this.name;this.uid&&(b+=this.uid);return j(a).getPath(b)},instanceCount:0,uid:0,loadable:H,templateOptions:null,subPath:null},{add:function(a){a instanceof this||(a=this(a));ga[a.name]=a},remove:function(a){ga[a]&&!ga[a].instanceCount&&
delete ga[a]},get:function(a){return ga[a]},fetch:function(a){return l(a+".app")},bootstrapApp:function(a,b,d,f){1==arguments.length?(b=F.body,d=""):2==arguments.length&&(b.jquery?(b=b[0],d=""):n(b)&&(d=b,b=F.body,d=""));var g=ga[a];g?g.bootstrap(b,d,f):this.fetch(a).done(function(){ga[a].bootstrap(b,d,f)})},shutdownApp:function(a,b){k(a)&&(a=b,b=F.body);var d=Aa.get(b,a);d&&d.app.shutdown(b,d.modelContainer)}});var Aa={get:function(a,b){return this.appData(a)[b]},add:function(a,b,d,f){this.appData(a)[d]=
{app:f,namespace:f.getNamespace(b),modelContainer:b}},remove:function(a,b){delete this.appData(a)[b]},appData:function(a,b){var d=g(a).hmData("app");!b&&!d&&(d={},g(a).hmData("app",d));return d}};j.behavior({app:function(a,b,d,f){d=ge.exec(g.trim(f));j.App.bootstrapApp(d[1],a,b,d[3])},unapp:function(a,b,d,f){g(a).mapEvent("click","shutdown."+f)},bootstrap:function(a,b,d,f){d=dd.exec(g.trim(f));var h=d[1],k=g(d[3])[0],l=d[5];g(a).click(function(){j.App.bootstrapApp(h,k,b,l)})},shutdown:function(a,
b,d,f){b=dd.exec(g.trim(f));var h=b[1],k=g(b[3])[0];g(a).click(function(){j.App.shutdownApp(h,k)})}});var he=g.cleanData;g.cleanData=function(a){g(a).each(function(){var a=Aa.appData(this,!0);if(a)for(var d in a){var f=a[d];delete a[d];f.unload(this,!0)}});he(a)};l.loader.set("app","js",{url:"folder"})})(jQuery,window);
